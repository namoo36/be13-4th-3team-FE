import{_ as S,i as v,a as n,o as l,d as o,p as i,D as m,F as p,k as f,t as r,g as D,v as h,y as k,j as H,e as B}from"./index-BaYYEV3U.js";const M={class:"table table-striped table-hover text-center"},R=["value"],O={key:0},P=["src"],$={key:1},G=["onChange"],j={key:0,class:"mt-2"},Q=["src"],Y=["onClick"],J={key:2},K={key:3},q=["onUpdate:modelValue"],z={key:4},W={key:5},X=["onUpdate:modelValue"],Z={key:6},tt={key:7},et=["onUpdate:modelValue"],ot={key:8},at={key:9},st=["onUpdate:modelValue"],nt={key:10},lt={key:11},dt=["onUpdate:modelValue"],rt={key:12},it={key:13},ct=["value","onUpdate:modelValue"],ut=["for"],_t={key:14},gt={key:15},ht=["value","onUpdate:modelValue"],It=["for"],yt={key:16},mt=["onClick"],pt={key:17},kt=["onClick"],Et=["onClick"],bt={__name:"RegistProductTable",props:{nsupplements:{type:Array,required:!0}},emits:["delete-item"],setup(N,{emit:u}){const E=u,c=v([]),d=v(!1),_=()=>{d.value?c.value=nsupplements.map(e=>e.productId):c.value=[]},g=["VITAMIN_B3","VITAMIN_B1","MAGNESIUM","PROTEIN","LUTEIN"],b=e=>{switch(e){case"VITAMIN_B3":return"비타민 B3";case"VITAMIN_B1":return"비타민 B1";case"MAGNESIUM":return"마그네슘";case"PROTEIN":return"단백질";case"LUTEIN":return"루테인";default:return e}},T=["GUT_HEALTH","EYE","FATIGUE","SKIN_HEALTH","LIVER","SLEEP","JOINT_HEALTH","FITNESS","BODY_FAT"],U=e=>{switch(e){case"GUT_HEALTH":return"장 건강";case"EYE":return"눈 건강";case"FATIGUE":return"피로 회복";case"SKIN_HEALTH":return"피부 건강";case"LIVER":return"간 건강";case"SLEEP":return"수면";case"JOINT_HEALTH":return"관절 건강";case"FITNESS":return"운동";case"BODY_FAT":return"체지방";default:return e}},V=()=>{if(c.value.length===0){alert("삭제할 상품을 선택하세요.");return}E("delete-item",c.value)},x=e=>{e.isEditing=!0,e.originalData={...e}},A=async e=>{let a=e.productImage;try{e.newImageFile&&(a=await L(e.newImageFile)||a),e.productImage===""&&(a=null);const t=e.ingredients||[],s=e.healthNames||[];(await k.post(`/nsupplement/${e.productId}`,{productImage:a,productName:e.productName,brand:e.brand,caution:e.caution,price:e.price,stockQuantity:e.stockQuantity,ingredients:t,hfunctionalItems:s})).status===200&&(e.isEditing=!1,delete e.originalData,delete e.newImageFile,alert("상품이 성공적으로 수정되었습니다."))}catch(t){console.error(t),alert("상품 수정에 실패했습니다.")}},w=e=>{Object.assign(e,e.originalData),e.isEditing=!1,delete e.originalData,delete e.newImageFile},F=e=>{e.productImage="",e.newImageFile=null},C=(e,a)=>{const t=a.target.files[0];if(t){const s=URL.createObjectURL(t);e.productImage=s,e.newImageFile=t}},L=async e=>{const a=new FormData;a.append("file",e);try{return(await k.post("/s3/upload",a,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(t){return console.error("Error uploading image:",t),alert("이미지 업로드에 실패했습니다."),null}};return(e,a)=>(l(),n(p,null,[o("table",M,[o("thead",null,[o("tr",null,[o("th",null,[i(o("input",{type:"checkbox","onUpdate:modelValue":a[0]||(a[0]=t=>d.value=t),onChange:_},null,544),[[m,d.value]])]),a[2]||(a[2]=o("th",null,"상품 Id",-1)),a[3]||(a[3]=o("th",null,"상품 사진",-1)),a[4]||(a[4]=o("th",null,"상품명",-1)),a[5]||(a[5]=o("th",null,"브랜드",-1)),a[6]||(a[6]=o("th",null,"주의사항",-1)),a[7]||(a[7]=o("th",null,"가격",-1)),a[8]||(a[8]=o("th",null,"재고",-1)),a[9]||(a[9]=o("th",null,"성분",-1)),a[10]||(a[10]=o("th",null,"건강기능",-1)),a[11]||(a[11]=o("th",null,null,-1))])]),o("tbody",null,[(l(!0),n(p,null,f(N.nsupplements,t=>(l(),n("tr",{key:t.productId},[o("td",null,[i(o("input",{type:"checkbox","onUpdate:modelValue":a[1]||(a[1]=s=>c.value=s),value:t.productId},null,8,R),[[m,c.value]])]),o("td",null,r(t.productId),1),t.isEditing?(l(),n("td",$,[o("input",{type:"file",class:"form-control",id:"productImage",onChange:s=>C(t,s),accept:"image/*"},null,40,G),t.productImage?(l(),n("div",j,[o("img",{src:t.productImage,alt:"상품 이미지 미리보기",class:"img-thumbnail",style:{"max-width":"200px"}},null,8,Q),o("button",{type:"button",class:"btn btn-danger mt-2",onClick:s=>F(t)},"이미지 삭제",8,Y)])):D("",!0)])):(l(),n("td",O,[o("img",{src:t.productImage,alt:"상품 이미지",style:{"max-width":"100px","max-height":"100px"}},null,8,P)])),t.isEditing?(l(),n("td",K,[i(o("input",{type:"text","onUpdate:modelValue":s=>t.productName=s},null,8,q),[[h,t.productName]])])):(l(),n("td",J,r(t.productName),1)),t.isEditing?(l(),n("td",W,[i(o("input",{type:"text","onUpdate:modelValue":s=>t.brand=s},null,8,X),[[h,t.brand]])])):(l(),n("td",z,r(t.brand),1)),t.isEditing?(l(),n("td",tt,[i(o("input",{type:"text","onUpdate:modelValue":s=>t.caution=s},null,8,et),[[h,t.caution]])])):(l(),n("td",Z,r(t.caution),1)),t.isEditing?(l(),n("td",at,[i(o("input",{type:"number","onUpdate:modelValue":s=>t.price=s},null,8,st),[[h,t.price]])])):(l(),n("td",ot,r(t.price),1)),t.isEditing?(l(),n("td",lt,[i(o("input",{type:"number","onUpdate:modelValue":s=>t.stockQuantity=s},null,8,dt),[[h,t.stockQuantity]])])):(l(),n("td",nt,r(t.stockQuantity),1)),t.isEditing?(l(),n("td",it,[(l(),n(p,null,f(g,(s,I)=>o("div",{key:I},[i(o("input",{type:"checkbox",class:"form-check-input",id:"ingredients",value:s,"onUpdate:modelValue":y=>t.ingredients=y},null,8,ct),[[m,t.ingredients]]),o("label",{class:"form-check-label",for:s},r(b(s)),9,ut)])),64))])):(l(),n("td",rt,r(t.ingredients.map(b).join(", ")),1)),t.isEditing?(l(),n("td",gt,[(l(),n(p,null,f(T,(s,I)=>o("div",{key:I},[i(o("input",{type:"checkbox",class:"form-check-input",id:"healthNames",value:s,"onUpdate:modelValue":y=>t.healthNames=y},null,8,ht),[[m,t.healthNames]]),o("label",{class:"form-check-label",for:s},r(b(s)),9,It)])),64))])):(l(),n("td",_t,r(t.healthNames.map(U).join(", ")),1)),t.isEditing?(l(),n("td",pt,[o("button",{onClick:s=>A(t)},"저장",8,kt),o("button",{onClick:s=>w(t)},"취소",8,Et)])):(l(),n("td",yt,[o("button",{onClick:s=>x(t)},"수정",8,mt)]))]))),128))])]),o("button",{type:"button",class:"btn btn-outline-danger",onClick:V},"선택된 상품 삭제")],64))}},ft=S(bt,[["__scopeId","data-v-f2165635"]]),Nt={__name:"RegistProductList",setup(N){const u=v([]),E=async()=>{try{const d=await k.get("/nsupplement");u.value=d.data}catch(d){d.response&&d.response.data.code===404?alert(d.response.data.message):alert("에러가 발생했습니다.")}};H(()=>{E()});const c=async d=>{try{const _=d.map(g=>k.delete(`/nsupplement/${g}`));await Promise.all(_),u.value=u.value.filter(g=>!d.includes(g.productId)),alert("선택된 상품이 삭제되었습니다.")}catch(_){alert("삭제 실패"),console.error(_)}};return(d,_)=>(l(),n("main",null,[B(ft,{nsupplements:u.value,onDeleteItem:c},null,8,["nsupplements"])]))}};export{Nt as default};
